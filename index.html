<!DOCTYPE html>
<html>
<head>
  <title>Reverse Bill Generator</title>
</head>
<body style="font-family: Arial, sans-serif; margin: 0; padding: 20px; background: #f2f2f2;">
  <div style="max-width: 900px; margin: auto; background: #fff; padding: 20px; border-radius: 10px;">
    <h2 style="text-align: center;">Reverse Bill Generator</h2>

    <div>
      <button onclick="addItem()" style="padding: 10px 15px; background: #28a745; color: white; border: none; border-radius: 5px;">+ Add Item</button>
      <button onclick="generateBill()" style="padding: 10px 15px; background: #007bff; color: white; border: none; border-radius: 5px; margin-left: 10px;">Generate Bill</button>
    </div>

    <div id="itemContainer" style="margin-top: 20px;"></div>

    <div id="output" style="margin-top: 30px;"></div>
  </div>

  <script>
    let itemId = 0;

    function addItem() {
      const container = document.getElementById("itemContainer");
      const div = document.createElement("div");
      div.id = "item-" + itemId++;
      div.style = "margin-bottom: 15px; display: flex; gap: 10px; align-items: center;";

      div.innerHTML = `
        <select style="padding: 5px;" class="product">
          <option value="Suit" data-hsn="5407">Suit (HSN: 5407)</option>
          <option value="Saree" data-hsn="5407">Saree (HSN: 5407)</option>
          <option value="Fabric" data-hsn="5408">Fabric (HSN: 5408)</option>
        </select>
        <input type="number" placeholder="Quantity" class="qty" style="width: 80px; padding: 5px;" min="1">
        <input type="number" placeholder="Unit Price (incl. GST)" class="price" style="width: 160px; padding: 5px;" step="0.01" min="0">
        <button onclick="this.parentElement.remove()" style="padding: 5px 10px; background: red; color: white; border: none; border-radius: 3px;">Remove</button>
      `;

      container.appendChild(div);
    }

    function generateBill() {
      const container = document.getElementById("itemContainer");
      const items = container.querySelectorAll("div");
      const resultDiv = document.getElementById("output");

      if (items.length === 0) {
        alert("Please add at least one item.");
        return;
      }

      let table = `
        <h3>Bill Summary</h3>
        <table style="width: 100%; border-collapse: collapse;">
          <tr style="background: #eee;">
            <th style="border: 1px solid #ccc; padding: 8px;">Product</th>
            <th style="border: 1px solid #ccc; padding: 8px;">HSN</th>
            <th style="border: 1px solid #ccc; padding: 8px;">Qty</th>
            <th style="border: 1px solid #ccc; padding: 8px;">Taxable Value</th>
            <th style="border: 1px solid #ccc; padding: 8px;">CGST 2.5%</th>
            <th style="border: 1px solid #ccc; padding: 8px;">SGST 2.5%</th>
            <th style="border: 1px solid #ccc; padding: 8px;">Total</th>
          </tr>
      `;

      let totalTaxable = 0, totalCGST = 0, totalSGST = 0, grandTotal = 0;

      for (const item of items) {
        const productSelect = item.querySelector(".product");
        const product = productSelect.value;
        const hsn = productSelect.options[productSelect.selectedIndex].dataset.hsn;
        const qty = parseInt(item.querySelector(".qty").value);
        const rate = parseFloat(item.querySelector(".price").value);

        if (!qty || !rate || qty <= 0 || rate <= 0) {
          alert("Please fill all fields correctly for each item.");
          return;
        }

        const grossTotal = qty * rate;
        const taxable = +(grossTotal / 1.05).toFixed(2);
        const cgst = +(taxable * 0.025).toFixed(2);
        const sgst = cgst;
        const total = taxable + cgst + sgst;

        totalTaxable += taxable;
        totalCGST += cgst;
        totalSGST += sgst;
        grandTotal += total;

        table += `
          <tr>
            <td style="border: 1px solid #ccc; padding: 8px;">${product}</td>
            <td style="border: 1px solid #ccc; padding: 8px;">${hsn}</td>
            <td style="border: 1px solid #ccc; padding: 8px; text-align: right;">${qty}</td>
            <td style="border: 1px solid #ccc; padding: 8px; text-align: right;">₹${taxable.toFixed(2)}</td>
            <td style="border: 1px solid #ccc; padding: 8px; text-align: right;">₹${cgst.toFixed(2)}</td>
            <td style="border: 1px solid #ccc; padding: 8px; text-align: right;">₹${sgst.toFixed(2)}</td>
            <td style="border: 1px solid #ccc; padding: 8px; text-align: right;">₹${total.toFixed(2)}</td>
          </tr>
        `;
      }

      table += `
        <tr style="font-weight: bold; background: #f9f9f9;">
          <td colspan="3" style="border: 1px solid #ccc; padding: 8px; text-align: right;">TOTAL</td>
          <td style="border: 1px solid #ccc; padding: 8px; text-align: right;">₹${totalTaxable.toFixed(2)}</td>
          <td style="border: 1px solid #ccc; padding: 8px; text-align: right;">₹${totalCGST.toFixed(2)}</td>
          <td style="border: 1px solid #ccc; padding: 8px; text-align: right;">₹${totalSGST.toFixed(2)}</td>
          <td style="border: 1px solid #ccc; padding: 8px; text-align: right;">₹${grandTotal.toFixed(2)}</td>
        </tr>
      </table>`;

      resultDiv.innerHTML = table;
    }
  </script>
</body>
</html>
